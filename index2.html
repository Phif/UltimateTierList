<html>

<body>
    <style>
        .container {
            width: 100px;
            height: 100px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .thumbnail {
            object-fit: cover;
            width: 100px;
            height: 100px;
        } 

        #preview {

        }
    </style>
    <div>
        <input type="file" id="image-input" accept="image/*" multiple>
    </div>
    <img id="preview"></img>    
    
    <script>
        let imgInput = document.getElementById('image-input');
        imgInput.addEventListener('change', function (e) {
            if (e.target.files) {
                let imageFile = e.target.files;
                console.log(imageFile[0]);
                for (let i = 0; i < imageFile.length; i++) {
                    var reader = new FileReader();
                    reader.onload = function (e) {
                        var div = document.createElement("div");   
                        div.setAttribute("id", `container-${i}`);

                        var img = document.createElement("img");
                        div.setAttribute("class", "container");
                        img.setAttribute("class", "thumbnail");
                        
                        img.addEventListener("load", function () {
                            var canvas = document.createElement("canvas");
                            var ctx = canvas.getContext("2d");
                            
                            var imageWidth = img.width;
                            var imageHeight = img.height;
                            
                            var maxWidth = 300;
                            var maxHeight = 300;
                            
                            if (imageWidth >= imageHeight) {
                                imageWidth = imageWidth*maxHeight/imageHeight;
                                imageHeight = maxHeight;
                            } else {
                                imageHeight = imageHeight*maxWidth/imageWidth;
                                imageWidth = maxWidth;
                            }
                            
                            canvas.setAttribute("width", imageWidth);
                            canvas.setAttribute("height", imageHeight);
                            
                            ctx.drawImage(img, 0, 0, imageWidth, imageHeight);
                            // ctx.drawImage(img, (maxWidth/2-imageWidth/2), (maxHeight/2-imageHeight/2), imageWidth, imageHeight);
                            
                            const dataurl = canvas.toDataURL(imageFile[i].type);
                            img.src = dataurl;
                            this.removeEventListener("load", arguments.callee);
                        });
                        img.src = e.target.result;
                        
                        document.body.appendChild(div);
                        div.appendChild(img);
                    }
                    reader.readAsDataURL(imageFile[i]);
                }
            }
        });
    </script>
</body>

</html>